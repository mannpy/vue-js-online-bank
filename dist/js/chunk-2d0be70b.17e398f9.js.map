{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","MIN_LENGTH","min","values","console","log","dispatch","push","computed","watch","val","setTimeout","name","setup","route","query","message","error","render","__scopeId"],"mappings":"qNAEI,eAAwB,UAApB,mBAAe,G,EAGjB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,mBAMzBC,MAAM,e,wEAhBb,eAiBO,QAjBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC1C,EAEA,eAIM,OAJAD,MAAK,yBAA6B,EAAAE,U,CACtC,E,eACA,eAA6D,SAAtDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAIM,OAJAF,MAAK,yBAA6B,EAAAO,U,CACtC,E,eACA,eAAsE,SAA/DJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAAsG,UAA9FP,MAAM,cAAcG,KAAK,SAAUO,SAAU,EAAAC,cAAgB,EAAAC,mBAAmB,QAAK,gBAC9D,EAAAA,mB,iBAA/B,eAAgH,MAAhH,EAAkD,6D,0HCX/C,SAASC,IACZ,IAAMC,EAAQC,iBACRC,EAASC,iBAFY,EAGyBC,iBAA5CC,EAHmB,EAGnBA,aAAcR,EAHK,EAGLA,aAAcS,EAHT,EAGSA,YAHT,EAKqCC,eAC5D,QACAC,SAEKC,OACAC,SAAS,6BACTnB,MAAM,kCANDA,EALa,EAKpBoB,MAA4BvB,EALR,EAKNwB,aAAkCpB,EAL5B,EAKgBqB,WASrCC,EAAa,EAdQ,EAgBwCP,eAC/D,WACAC,SAEKC,OACAC,SAAS,8BACTK,IAAID,EAJT,sCAIoDA,EAJpD,gBAFUpB,EAhBa,EAgBpBiB,MAA+BlB,EAhBX,EAgBHmB,aAAkCjB,EAhB/B,EAgBmBkB,WASxC1B,EAAWkB,EAAY,yDAAC,WAAMW,GAAN,wFAC1BC,QAAQC,IAAIF,GADc,kBAGhBhB,EAAMmB,SAAS,aAAcH,GAHb,OAItBd,EAAOkB,KAAK,KAJU,0GAAD,uDAQvBtB,EAAoBuB,gBAAS,kBAAMf,EAAYK,OAAS,KAQ9D,OANAW,eAAMxB,GAAmB,SAAAyB,GACjBA,GACAC,YAAW,kBAAMlB,EAAYK,MAAQ,IAAG,SAIzC,CACHpB,QACAG,WACAN,SACAK,SACAD,QACAG,QACAR,WACAU,eACAC,qB,gBD7BO,GACb2B,KAAM,OACNC,MAFa,WAGX,IAAMC,EAAQ,iBACR3B,EAAQ,iBAOd,OANI2B,EAAMC,MAAMC,SACd7B,EAAMmB,SAAS,aAAc,CAC3BR,MAAO,OAAAmB,EAAA,MAAMH,EAAMC,MAAMC,SACzBxC,KAAM,YAGHU,MEnCX,EAAOgC,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/chunk-2d0be70b.17e398f9.js","sourcesContent":["<template>\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\n    <h1>Войти в систему</h1>\n\n    <div :class=\"['form-control', {invalid: eError}]\">\n      <label for=\"email\">Email</label>\n      <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\n      <small v-if=\"eError\">{{ eError }}</small>\n    </div>\n\n    <div :class=\"['form-control', {invalid: pError}]\">\n      <label for=\"password\">Пароль</label>\n      <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\n      <small v-if=\"pError\">{{ pError }}</small>\n    </div>\n\n    <button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\n    <div class=\"text-danger\" v-if=\"isTooManyAttempts\">Вы слишком часто пытаетесь войти. Попробуйте зайти позже</div>\n  </form>\n</template>\n\n<script>\nimport {useLoginForm} from \"@/use/login-form\";\nimport {useRoute} from \"vue-router\";\nimport {useStore} from \"vuex\";\nimport {error} from \"@/utils/error\";\n\nexport default {\n  name: \"Auth\",\n  setup() {\n    const route = useRoute()\n    const store = useStore()\n    if (route.query.message) {\n      store.dispatch('setMessage', {\n        value: error(route.query.message),\n        type: 'warning'\n      })\n    }\n    return useLoginForm()\n  }\n}\n</script>\n\n<style scoped>\n\n</style>","import {useField, useForm} from \"vee-validate\";\nimport * as yup from \"yup\";\nimport {computed, watch} from \"vue\";\nimport {useStore} from 'vuex'\nimport {useRouter} from 'vue-router'\n\nexport function useLoginForm() {\n    const store = useStore()\n    const router = useRouter()\n    const { handleSubmit, isSubmitting, submitCount } = useForm()\n\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\n        'email',\n        yup\n            .string()\n            .trim()\n            .required(\"Пожалуйста введите email.\")\n            .email(\"Нужно ввести корректный email\")\n    )\n\n    const MIN_LENGTH = 6\n\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\n        'password',\n        yup\n            .string()\n            .trim()\n            .required(\"Пожалуйста введите пароль.\")\n            .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов.`)\n    )\n\n    const onSubmit = handleSubmit(async values => {\n        console.log(values)\n        try {\n            await store.dispatch('auth/login', values)\n            router.push('/')\n        } catch (e) {}\n    })\n\n    const isTooManyAttempts = computed(() => submitCount.value >= 3)\n\n    watch(isTooManyAttempts, val => {\n        if (val) {\n            setTimeout(() => submitCount.value = 0, 1500)\n        }\n    })\n\n    return {\n        email,\n        password,\n        eError,\n        pError,\n        eBlur,\n        pBlur,\n        onSubmit,\n        isSubmitting,\n        isTooManyAttempts\n    }\n}","import { render } from \"./Auth.vue?vue&type=template&id=2558dbbc&scoped=true\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-2558dbbc\"\n\nexport default script"],"sourceRoot":""}